{"ast":null,"code":"import{Link}from'react-router-dom';import'../css/header.css';import'bootstrap/dist/css/bootstrap.css';import'bootstrap-icons/font/bootstrap-icons.css';import{useLanguage}from'../store/languageContext';import{useTheme}from'../store/themeContext';import{useEffect,useState}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Header(){const{language,setLanguage,languageData}=useLanguage();const[userName,setUsername]=useState();const[mdp,setMdp]=useState();const{theme,setTheme,themeData}=useTheme();const[errorMessage,setErrorMessage]=useState(\"\");// Pour afficher les messages d'erreur\nconst changeTheme=()=>{const newTheme=theme===\"light\"?\"dark\":\"light\";setTheme(newTheme);};const changeLang=()=>{const newLang=language===\"fr\"?\"en\":\"fr\";setLanguage(newLang);};useEffect(()=>{// Fonction pour récupérer le userName depuis sessionStorage\nconst handleStorageChange=()=>{const storedUserName=sessionStorage.getItem(\"userName\");// Vérifier sessionStorage\nconst storedMdp=sessionStorage.getItem(\"mdp\");// Vérifier sessionStorage\nif(storedUserName){setUsername(storedUserName);console.log(\"Stored username: \",storedUserName);}else{setUsername('');// Réinitialiser si non trouvé\n}if(storedMdp){setMdp(storedMdp);console.log(\"Stored mdp: \",storedMdp);}else{setMdp('');// Réinitialiser si non trouvé\n}};// Initialiser le userName au premier rendu\nhandleStorageChange();// Ajouter un écouteur pour les changements dans le sessionStorage\nwindow.addEventListener('storage',handleStorageChange);// Nettoyer l'écouteur au démontage du composant\nreturn()=>{window.removeEventListener('storage',handleStorageChange);};},[]);const disconnect=async()=>{try{const response=await fetch('http://localhost/word-box/server/routeur.php',{method:'POST',headers:{'Content-Type':'application/x-www-form-urlencoded'},body:new URLSearchParams({objet:'Client',action:'disconnect',username:userName,mdp:mdp})});if(!response.ok){throw new Error('Network response was not ok');}const data=await response.json();console.log('reponse webservice',data);return data.data;}catch(error){console.error(\"Erreur lors de la création du compte :\",error);return false;}};// Appeler la fonction checkCredentials dans handleSubmit\nconst handleDisconnection=async e=>{e.preventDefault();const isValid=await disconnect();if(isValid){sessionStorage.removeItem('userName');// Supprimer le nom d'utilisateur du sessionStorage\nwindow.location.href=\"/connexion\";// Rediriger vers la page d'accueil\n}else{setErrorMessage(\"Échec de la déconnexion. Disconnection Failed.\");}};return/*#__PURE__*/_jsxs(\"header\",{class:themeData.header,children:[/*#__PURE__*/_jsxs(\"div\",{class:themeData.title,children:[/*#__PURE__*/_jsx(\"i\",{class:\"bi bi-book\"}),/*#__PURE__*/_jsx(\"h1\",{style:{fontFamily:'Lucida Handwriting'},\"data-translate-key\":\"wordBox\",children:\"Bo\\xEEte \\xE0 mot\"})]}),/*#__PURE__*/_jsxs(\"nav\",{class:themeData.navBar,children:[/*#__PURE__*/_jsxs(\"div\",{class:themeData.alignRedirectPage,children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:`/home`,\"data-translate-key\":\"home\",children:languageData.home})}),!userName?/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:`/connexion`,\"data-translate-key\":\"connexion\",children:languageData.connexion})}):\"\",!userName?/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:`/inscription`,\"data-translate-key\":\"signIn\",children:languageData.signIn})}):\"\",/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:`/mes-mots`,\"data-translate-key\":\"favList\",children:languageData.favList})})]}),/*#__PURE__*/_jsxs(\"div\",{class:\"settings\",children:[userName?/*#__PURE__*/_jsxs(\"i\",{class:\"bi bi-person-check\",onClick:handleDisconnection,children:[\" \",userName]}):\"\",/*#__PURE__*/_jsx(\"i\",{class:`bi ${theme===\"light\"?\"bi-brightness-high\":\"bi-moon-stars-fill\"}`,id:\"theme\",onClick:changeTheme}),/*#__PURE__*/_jsx(\"i\",{class:`flag-icon-${language===\"fr\"?\"en\":\"fr\"}`,id:\"lang\",onClick:changeLang})]})]})]});}export default Header;","map":{"version":3,"names":["Link","useLanguage","useTheme","useEffect","useState","jsx","_jsx","jsxs","_jsxs","Header","language","setLanguage","languageData","userName","setUsername","mdp","setMdp","theme","setTheme","themeData","errorMessage","setErrorMessage","changeTheme","newTheme","changeLang","newLang","handleStorageChange","storedUserName","sessionStorage","getItem","storedMdp","console","log","window","addEventListener","removeEventListener","disconnect","response","fetch","method","headers","body","URLSearchParams","objet","action","username","ok","Error","data","json","error","handleDisconnection","e","preventDefault","isValid","removeItem","location","href","class","header","children","title","style","fontFamily","navBar","alignRedirectPage","to","home","connexion","signIn","favList","onClick","id"],"sources":["C:/Users/melis/OneDrive/Documents/ENSIIE/S1/web/PROJET-1/boite-a-mot-good-vers/front/src/components/header.jsx"],"sourcesContent":["import { Link } from 'react-router-dom';\r\nimport '../css/header.css';\r\nimport 'bootstrap/dist/css/bootstrap.css';\r\nimport 'bootstrap-icons/font/bootstrap-icons.css';\r\nimport { useLanguage } from '../store/languageContext';\r\nimport { useTheme } from '../store/themeContext';\r\nimport { useEffect, useState } from 'react';\r\n\r\nfunction Header() {\r\n    const { language, setLanguage, languageData } = useLanguage();\r\n    const [userName, setUsername] = useState();\r\n    const [mdp, setMdp] = useState();\r\n    const { theme, setTheme, themeData } = useTheme();\r\n    const [errorMessage, setErrorMessage] = useState(\"\"); // Pour afficher les messages d'erreur\r\n\r\n    const changeTheme = () => {\r\n        const newTheme = theme === \"light\" ? \"dark\" : \"light\";\r\n        setTheme(newTheme);\r\n    };\r\n\r\n    const changeLang = () => {\r\n        const newLang = language === \"fr\" ? \"en\" : \"fr\";\r\n        setLanguage(newLang);\r\n    };\r\n\r\n    useEffect(() => {\r\n        // Fonction pour récupérer le userName depuis sessionStorage\r\n        const handleStorageChange = () => {\r\n            const storedUserName = sessionStorage.getItem(\"userName\"); // Vérifier sessionStorage\r\n            const storedMdp = sessionStorage.getItem(\"mdp\"); // Vérifier sessionStorage\r\n\r\n            if (storedUserName) {\r\n                setUsername(storedUserName);\r\n                console.log(\"Stored username: \", storedUserName);\r\n            } else {\r\n                setUsername(''); // Réinitialiser si non trouvé\r\n            }\r\n\r\n            if (storedMdp) {\r\n                setMdp(storedMdp);\r\n                console.log(\"Stored mdp: \", storedMdp);\r\n            } else {\r\n                setMdp(''); // Réinitialiser si non trouvé\r\n            }\r\n        };\r\n\r\n        // Initialiser le userName au premier rendu\r\n        handleStorageChange();\r\n\r\n        // Ajouter un écouteur pour les changements dans le sessionStorage\r\n        window.addEventListener('storage', handleStorageChange);\r\n\r\n        // Nettoyer l'écouteur au démontage du composant\r\n        return () => {\r\n            window.removeEventListener('storage', handleStorageChange);\r\n        };\r\n    }, []);\r\n\r\n\r\n    const disconnect = async () => {\r\n        try {\r\n            const response = await fetch('http://localhost/word-box/server/routeur.php', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/x-www-form-urlencoded',\r\n                },\r\n                body: new URLSearchParams({\r\n                    objet: 'Client',\r\n                    action: 'disconnect',\r\n                    username: userName,\r\n                    mdp: mdp,\r\n\r\n                }),\r\n            });\r\n\r\n            if (!response.ok) {\r\n                throw new Error('Network response was not ok');\r\n            }\r\n            const data = await response.json();\r\n            console.log('reponse webservice', data);\r\n            return data.data;\r\n        } catch (error) {\r\n            console.error(\"Erreur lors de la création du compte :\", error);\r\n            return false;\r\n        }\r\n    };\r\n\r\n    // Appeler la fonction checkCredentials dans handleSubmit\r\n    const handleDisconnection = async (e) => {\r\n        e.preventDefault();\r\n\r\n        const isValid = await disconnect();\r\n        if (isValid) {\r\n            sessionStorage.removeItem('userName'); // Supprimer le nom d'utilisateur du sessionStorage\r\n            window.location.href = \"/connexion\"; // Rediriger vers la page d'accueil\r\n        } else {\r\n            setErrorMessage(\"Échec de la déconnexion. Disconnection Failed.\");\r\n        }\r\n    };\r\n\r\n    return (\r\n        <header class={themeData.header}>\r\n            <div class={themeData.title}>\r\n                <i class=\"bi bi-book\"></i>\r\n                <h1 style={{ fontFamily: 'Lucida Handwriting' }} data-translate-key=\"wordBox\">\r\n                    Boîte à mot\r\n                </h1>\r\n            </div>\r\n\r\n            <nav class={themeData.navBar}>\r\n                <div class={themeData.alignRedirectPage}>\r\n                    <li><Link to={`/home`} data-translate-key=\"home\">{languageData.home}</Link></li>\r\n                    {!userName ? (\r\n                        <li><Link to={`/connexion`} data-translate-key=\"connexion\">{languageData.connexion}</Link></li>) : \"\"}\r\n                    {!userName ? (\r\n                        <li><Link to={`/inscription`} data-translate-key=\"signIn\">{languageData.signIn}</Link></li>) : \"\"}\r\n\r\n                    <li><Link to={`/mes-mots`} data-translate-key=\"favList\">{languageData.favList}</Link></li>\r\n                </div>\r\n\r\n                <div class=\"settings\">\r\n                    { userName ? (\r\n                        <i class=\"bi bi-person-check\" onClick={handleDisconnection}> {userName}</i>\r\n                    ) : \"\"}\r\n                    <i class={`bi ${theme === \"light\" ? \"bi-brightness-high\" : \"bi-moon-stars-fill\"}`} id=\"theme\" onClick={changeTheme}></i>\r\n                    <i class={`flag-icon-${language === \"fr\" ? \"en\" : \"fr\"}`} id=\"lang\" onClick={changeLang}></i>\r\n                </div>\r\n            </nav>\r\n        </header>\r\n    );\r\n}\r\n\r\nexport default Header;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}